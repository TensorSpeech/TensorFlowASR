# Copyright 2020 Huy Le Nguyen (@usimarit)
#
# Licensed under the Apache License, Version 2.0 (the "License");
# you may not use this file except in compliance with the License.
# You may obtain a copy of the License at
#
#     http://www.apache.org/licenses/LICENSE-2.0
#
# Unless required by applicable law or agreed to in writing, software
# distributed under the License is distributed on an "AS IS" BASIS,
# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
# See the License for the specific language governing permissions and
# limitations under the License.

speech_config:
    sample_rate:           16000
    frame_ms:              25
    stride_ms:             10
    num_feature_bins:      80
    feature_type:          logfbank
    preemphasis:           0.97
    delta:                 True
    delta_delta:           True
    normalize_signal:      True
    normalize_feature:     True
    normalize_per_feature: False
    pitch:                 False

decoder_config:
    vocabulary: /mnt/Projects/asrk16/vnasr/datasets/vocabulary.txt
    name:       beamsearch
    beam_width: 500
    lm_path:    /mnt/Data/ML/NLP/vntc_asr_5gram_trie.binary
    alpha:      2.0
    beta:       1.0

model_config:
    name: ds2
    architecture:
        conv_conf:
            conv_dropout: 0
        rnn_conf:
            rnn_layers:        3
            rnn_type:          lstm
            rnn_units:         350
            rnn_bidirectional: True
            rnn_rowconv:       False
            rnn_dropout:       0
        fc_conf:
            fc_units: null

learning_config:
    augmentations:
        include_original:  True
        before:
            white_noise:
                snr_list: [0, 5, 10, 15]
            real_world_noise:
                snr_list: [0, 5, 10, 15]
                noise_dir:  /mnt/Data/ML/ASR/Preprocessed/Noises
                max_noises: 3
            time_stretch:
                min_ratio: 0.5
                max_ratio: 2
        after:
            time_masking:
                num_time_mask:   1
                time_mask_param: 77
                p_upperbound:    0.2
            freq_masking:
                num_freq_mask:   1
                freq_mask_param: 22

    dataset_config:
        batch_size:        8
        train_paths:
            - /mnt/Data/ML/ASR/Preprocessed/Vivos/train/transcripts.tsv
        eval_paths: []
        test_paths:
            - /mnt/Data/ML/ASR/Preprocessed/Vivos/test/transcripts.tsv
        tfrecords_dir:     /mnt/Data/ML/ASR/Preprocessed/Vivos/TFRecords

    optimizer:
        class_name: adam
        config:
            learning_rate: 0.0001

    running_config:
        num_epochs:          20
        outdir:              /mnt/Projects/asrk16/trained/local/vivos
        log_interval_steps:  500
        eval_interval_steps: 500
        save_interval_steps: 1000
        time_interval_steps: 500
